import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a as i,o as n}from"./app-CGXHKXsa.js";const t={};function e(p,s){return n(),l("div",null,s[0]||(s[0]=[i('<h1 id="样本" tabindex="-1"><a class="header-anchor" href="#样本"><span>样本</span></a></h1><h2 id="正样本" tabindex="-1"><a class="header-anchor" href="#正样本"><span>正样本</span></a></h2><ul><li>正样本：曝光而且有点击的用户一物品二元组。(用户对物品感兴趣)。</li><li>问题：少部分物品占据大部分，点击，导致正样本大多是热门物品。</li><li>解决方案：<strong>过采样冷门</strong>物品，或<strong>降采样热门</strong>物品。 <ul><li>过采样（up-sampling）：一个样本出现多次。</li><li>降采样（down-sampling）：一些样本被抛弃。</li></ul></li></ul><h2 id="负样本" tabindex="-1"><a class="header-anchor" href="#负样本"><span>负样本</span></a></h2><p><img src="https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817231306115.png" alt="image-20250817231306115" loading="lazy"></p><h3 id="简单负样本-全体物品" tabindex="-1"><a class="header-anchor" href="#简单负样本-全体物品"><span>简单负样本：全体物品</span></a></h3><ul><li>未被召回的物品，大概率是用户不感兴趣的。</li><li>未被召回的物品 ≈ 全体物品</li><li>从全体物品中做抽样，作为负样本。</li><li>均匀抽样 or 非均匀抽样？</li></ul><hr><p>均匀抽样：对冷门物品不公平</p><ul><li>正样本大多是热门物品。</li><li>如果均匀抽样产生负样本，负样本大多是冷门物品。</li></ul><p>非均抽采样：目的是打压热门物品</p><ul><li>负样本抽样概率与热门程度（点击次数)正相关。</li><li>抽样概率 正比于（点击次数）^0.75</li></ul><p>Batch 内负样本</p><ul><li>一个物品出现在 batch 内的概率 正比于 点击次数。</li><li>物品成为负样本的概率本该是 正比于（点击次数）^0.75，但在这里是正比于 点击次数</li><li>热门物品成为负样本的概率过大。</li></ul><h3 id="纠偏" tabindex="-1"><a class="header-anchor" href="#纠偏"><span>纠偏</span></a></h3><blockquote><p>参考文献：</p><ol><li>Xinyang Yi et al.Sampling-Bias-Corrected Neural Modeling for Large Corpus Item Recommendations. In RecSys,2019.</li></ol></blockquote><ul><li>物品被抽样到的概率： <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 正比于 点击次数</li></ul></li><li>预估用户对物品的兴趣 <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\cos(a,b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li>做训练的时候，调整为：（召回时不需要） <ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\\cos(a,b_i)-\\log p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ul></li></ul><h3 id="困难负样本" tabindex="-1"><a class="header-anchor" href="#困难负样本"><span>困难负样本</span></a></h3><ul><li>困难负样本： <ul><li>被粗排淘汰的物品（比较困难)。</li><li>精排分数靠后的物品（非常困难)。</li></ul></li><li>对正负样本做二元分类： <ul><li>全体物品（简单）分类准确率高</li><li>被粗排淘汰的物品（比较困难）容易分错</li><li>精排分数靠后的物品（非常困难）更容易分错。</li></ul></li></ul><p>训练数据</p><ul><li>混合几种负样本。</li><li>50%的负样本是全体物品（简单负样本)。</li><li>50%的负样本是没通过排序的物品（困难负样本)。</li></ul><p>常见错误</p><ul><li>曝光但是没有点击 <ul><li>训练召回模型不能用这类负样本</li><li>训练排序模型会用这类负样本</li></ul></li></ul><p>选择负样本的原理</p><p>召回的目标：快速找到用户可能感兴趣的物品。</p><ul><li>全体物品(easy)：绝大多数是用户根本不感兴趣的。</li><li>被排序淘汰(hard)：用户可能感兴趣，但是不够感兴趣。</li><li>有曝光没点击（没用）：用户感兴趣，可能碰巧没有点击。</li></ul><hr><ul><li>正样本：曝光而且有点击。</li><li>简单负样本： <ul><li>全体物品。</li><li>batch 内负样本。</li></ul></li><li>困难负样本：被召回，但是被排序淘汰。</li><li>错误：曝光、但是未，点击的物品做召回的负样本。</li></ul>',28)]))}const o=a(t,[["render",e],["__file","sample.html.vue"]]),c=JSON.parse(`{"path":"/ai/rec/retrieval/dssm/sample.html","title":"样本","lang":"en-US","frontmatter":{"description":"样本 正样本 正样本：曝光而且有点击的用户一物品二元组。(用户对物品感兴趣)。 问题：少部分物品占据大部分，点击，导致正样本大多是热门物品。 解决方案：过采样冷门物品，或降采样热门物品。 过采样（up-sampling）：一个样本出现多次。 降采样（down-sampling）：一些样本被抛弃。 负样本 image-20250817231306115 ...","head":[["meta",{"property":"og:url","content":"https://davidliuk.github.io/blog/blog/ai/rec/retrieval/dssm/sample.html"}],["meta",{"property":"og:site_name","content":"David's Blog"}],["meta",{"property":"og:title","content":"样本"}],["meta",{"property":"og:description","content":"样本 正样本 正样本：曝光而且有点击的用户一物品二元组。(用户对物品感兴趣)。 问题：少部分物品占据大部分，点击，导致正样本大多是热门物品。 解决方案：过采样冷门物品，或降采样热门物品。 过采样（up-sampling）：一个样本出现多次。 降采样（down-sampling）：一些样本被抛弃。 负样本 image-20250817231306115 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817231306115.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-10-26T05:16:21.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-26T05:16:21.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"样本\\",\\"image\\":[\\"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817231306115.png\\"],\\"dateModified\\":\\"2025-10-26T05:16:21.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"David Liu\\",\\"url\\":\\"https://github.com/davidliuk\\"}]}"]]},"headers":[{"level":2,"title":"正样本","slug":"正样本","link":"#正样本","children":[]},{"level":2,"title":"负样本","slug":"负样本","link":"#负样本","children":[{"level":3,"title":"简单负样本：全体物品","slug":"简单负样本-全体物品","link":"#简单负样本-全体物品","children":[]},{"level":3,"title":"纠偏","slug":"纠偏","link":"#纠偏","children":[]},{"level":3,"title":"困难负样本","slug":"困难负样本","link":"#困难负样本","children":[]}]}],"git":{"createdTime":1756619527000,"updatedTime":1761455781000,"contributors":[{"name":"dawei.liu","email":"dawei.liu@bytedance.com","commits":2}]},"readingTime":{"minutes":2.41,"words":724},"filePathRelative":"ai/rec/retrieval/dssm/sample.md","localizedDate":"August 31, 2025","excerpt":"\\n<h2>正样本</h2>\\n<ul>\\n<li>正样本：曝光而且有点击的用户一物品二元组。(用户对物品感兴趣)。</li>\\n<li>问题：少部分物品占据大部分，点击，导致正样本大多是热门物品。</li>\\n<li>解决方案：<strong>过采样冷门</strong>物品，或<strong>降采样热门</strong>物品。\\n<ul>\\n<li>过采样（up-sampling）：一个样本出现多次。</li>\\n<li>降采样（down-sampling）：一些样本被抛弃。</li>\\n</ul>\\n</li>\\n</ul>\\n<h2>负样本</h2>\\n<p><img src=\\"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817231306115.png\\" alt=\\"image-20250817231306115\\" loading=\\"lazy\\"></p>","autoDesc":true}`);export{o as comp,c as data};
