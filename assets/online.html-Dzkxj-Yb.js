import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a as t,o as a}from"./app-C_tIvXCt.js";const n={};function r(o,e){return a(),l("div",null,e[0]||(e[0]=[t('<h1 id="线上服务" tabindex="-1"><a class="header-anchor" href="#线上服务"><span>线上服务</span></a></h1><h2 id="线上召回" tabindex="-1"><a class="header-anchor" href="#线上召回"><span>线上召回</span></a></h2><p><img src="https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250825110418374.png" alt="image-20250825110418374" loading="lazy"></p><p>离线存储：把物品向量b存入向量数据库</p><ol><li>完成训练之后，用物品塔计算每个物品的特征向量b</li><li>把几亿个物品向量b存入向量数据库（比如Milvus、Faiss、HnswLib）</li><li>向量数据库建索引，以便加速最近邻查找。</li></ol><p>线上召回：查找用户最感兴趣的k个物品</p><ol><li>给定用户ID和画像，线上用神经网络算用户向量a。</li><li>最近邻查找： <ul><li>把向量a作为query，调用向量数据库做最近邻查找。</li><li>返回余弦相似度最大的k个物品，作为召回结果。</li></ul></li></ol><p>why：事先存储物品向量b，线上现算用户向量a</p><ul><li>每做一次召回，用到一个用户向量a，几亿物品向量b。(线上算物品向量的代价过大)</li><li>用户兴趣动态变化，而物品特征相对稳定。（可以离线存储用户向量，但不利于推荐效果)</li></ul><h2 id="模型更新" tabindex="-1"><a class="header-anchor" href="#模型更新"><span>模型更新</span></a></h2><p><img src="https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817233740639.png" alt="image-20250817233740639" loading="lazy"></p><p>全量更新：今天凌晨，用昨天全天的数据训练模型。</p><ul><li>在昨天模型参数的基础上做训练。（不是随机初始化)》</li><li>用昨天的数据，训练1 epoch,即每天数据只用一遍。</li><li>发布新的用户塔神经网络和物品向量，供线上召回使用</li><li>全量更新对数据流、系统的要求比较低。</li></ul><p>增量更新：做online learning更新模型参数。</p><ul><li>用户兴趣会随时发生变化。</li><li>实时收集线上数据，做流式处理，生成TFRecord文件。</li><li>对模型做online learning,增量更新ID Embedding参数。(不更新神经网络其他部分的参数。)</li><li>发布用户ID Embedding,供用户塔在线上计算用户向量</li></ul><p>问题：能否只做增量更新，不做全量更新？</p><ul><li>小时级数据有偏；分钟级数据偏差更大。</li><li>全量更新：random shuffle一天的数据，做1 epoch训练。</li><li>增量更新：按照数据从早到晚的顺序，做1 epoch训练。</li><li><strong>随机打乱优于按顺序排列数据</strong>，全量训练优于增量训练。</li></ul>',17)]))}const d=i(n,[["render",r],["__file","online.html.vue"]]),m=JSON.parse(`{"path":"/ai/rec/retrieval/dssm/online.html","title":"线上服务","lang":"en-US","frontmatter":{"description":"线上服务 线上召回 image-20250825110418374 离线存储：把物品向量b存入向量数据库 完成训练之后，用物品塔计算每个物品的特征向量b 把几亿个物品向量b存入向量数据库（比如Milvus、Faiss、HnswLib） 向量数据库建索引，以便加速最近邻查找。 线上召回：查找用户最感兴趣的k个物品 给定用户ID和画像，线上用神经网络算用户...","head":[["meta",{"property":"og:url","content":"https://davidliuk.github.io/blog/blog/ai/rec/retrieval/dssm/online.html"}],["meta",{"property":"og:site_name","content":"David's Blog"}],["meta",{"property":"og:title","content":"线上服务"}],["meta",{"property":"og:description","content":"线上服务 线上召回 image-20250825110418374 离线存储：把物品向量b存入向量数据库 完成训练之后，用物品塔计算每个物品的特征向量b 把几亿个物品向量b存入向量数据库（比如Milvus、Faiss、HnswLib） 向量数据库建索引，以便加速最近邻查找。 线上召回：查找用户最感兴趣的k个物品 给定用户ID和画像，线上用神经网络算用户..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250825110418374.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-08-31T05:52:07.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-31T05:52:07.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"线上服务\\",\\"image\\":[\\"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250825110418374.png\\",\\"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250817233740639.png\\"],\\"dateModified\\":\\"2025-08-31T05:52:07.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"David Liu\\",\\"url\\":\\"https://github.com/davidliuk\\"}]}"]]},"headers":[{"level":2,"title":"线上召回","slug":"线上召回","link":"#线上召回","children":[]},{"level":2,"title":"模型更新","slug":"模型更新","link":"#模型更新","children":[]}],"git":{"createdTime":1756619527000,"updatedTime":1756619527000,"contributors":[{"name":"dawei.liu","email":"dawei.liu@bytedance.com","commits":1}]},"readingTime":{"minutes":1.85,"words":554},"filePathRelative":"ai/rec/retrieval/dssm/online.md","localizedDate":"August 31, 2025","excerpt":"\\n<h2>线上召回</h2>\\n<p><img src=\\"https://gcore.jsdelivr.net/gh/davidliuk/images@master/image-20250825110418374.png\\" alt=\\"image-20250825110418374\\" loading=\\"lazy\\"></p>\\n<p>离线存储：把物品向量b存入向量数据库</p>\\n<ol>\\n<li>完成训练之后，用物品塔计算每个物品的特征向量b</li>\\n<li>把几亿个物品向量b存入向量数据库（比如Milvus、Faiss、HnswLib）</li>\\n<li>向量数据库建索引，以便加速最近邻查找。</li>\\n</ol>","autoDesc":true}`);export{d as comp,m as data};
