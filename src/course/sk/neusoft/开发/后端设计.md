# 后端

## 设计

### 信息流

- **order** 订单

  类型：新订、换货、退货、退订（、全部）

  状态：待支付、已支付（待调度）、已调度（待出库）、已出库、已入库（待分配）、已分配（待领货）、已领货（待收货）、已收货（完成）、取消

  调拨单、出库单（入库单）、分发单（验货单）、任务单、签收单

  > 待支付、可调度/撤销、已调度、中心库房出库、配送站到货、可分配、已分配、已领货、完成、失败、缺货

- **work order** 任务单（配送->用户）

  类型：送货/配送、换货、退货（这些任务都会产生回执任务单）

  状态：已调度（待出库）、已出库、已入库（待分配）、已分配（待领货）、已领货（待收货）、已收货（完成）、取消

  > 已调度、可分配、已分配、已领货、（待收货）、完成、失败等

- **Invoice** 发票

  状态：待领用、已领用、已退回、取消

- receipt 签收单

  - 签收单号、
  - 任务单ID、
  - 客户ID
  - 客户姓名、
  - 联系电话、
  - 邮编、
  - 送货地址、
  - 送货日期、
  - 送货要求、
  - 送货分站、
    - ID
    - name
    - 地址、
    - 电话、
  - 是否要发票、
  - 订单ID
  - 备注、
  - 客户满意度
  - 客户反馈、

- **check order** 分发/验货单（仓库->物流公司->分站）

  状态：已出库、已入库（待分配）、取消

- **storage order** 出/入库单

  状态：已出库、已入库（待分配）、取消

  分发单=验货单

  出库单=分发单汇总X

- **Purchase order** 购货单（供应商->仓库）

- **transfer order** 调拨单（仓库->分站）

  意义：确定仓库、分站、物流公司
  
  状态：已调度（待出库）、已出库、已入库（待分配）、取消

## 操作

### 进货

- 

### 送货

- 支付（客户端）、

  修改：订单

- 调度（管理端：调度）

  - 自动、
  - 非自动

  意义：确认分站、物流公司

  生成：任务单、调拨单

  修改：任务单、订单

- 出库（管理端：仓库）、

  生成：验货单、库存单

  修改：验货单

- 入库（管理端：分站）、

  生成：库存单

  修改：验货单

- 分配（管理端：分站）、

  意义：确认配送员

  - 自动、
  - 非自动

  修改：任务单、订单

- 领货（配送端）、

  修改：任务单、订单

- 收货（客户端）、

  修改：任务单、订单

- 退货（客户端）

  判断订单状态，产生后续操作

  - 还未出库，则直接退、

    修改各个单状态为取消，无额外后续操作

    - 一个任务单
    - 一个调拨单

  - 已经出库，则等分站入库，再从分站往回退

    修改：任务单、订单

    状态、产生信息：

    - 两个库存单、
    - 一个任务单
    - 一个调拨单
    - 一个验货单

    操作：

    - 入库（管理端：分站）、
    - 退货出站（管理端：分站）、
    - 退货入库（管理端：仓库）、

  - 已经入库/分配，则分站点击退货

    操作：

    - 退货出站（管理端：分站）、
    - 退货入库（管理端：仓库）、

  - 已经领货，则分站确认入库

    操作：

    - 退货入站（管理端：分站）、
    - 退货出站（管理端：分站）、
    - 退货入库（管理端：仓库）、

  - 已经送达，则配送上门领货、分站确认入库

    操作：

    - 退货分配（管理端：分站）
    - 退货领货（配送端）、
    - 退货入站（管理端：分站）、
    - 退货出站（管理端：分站）、
    - 退货入库（管理端：仓库）、





## 管理端

### 权限管理

角色：超级管理员

- 用户管理
  - CRUD
  - 分配角色
- 角色管理
  - CRUD
  - 分配权限
- 权限管理
  - CRUD

### 人员管理

角色：超级管理员/用户管理员

- 用户维护

  增删改查

- 配送员维护


### 调度管理

角色：调度管理员

- 区域管理

调度中心的主要职责是对客服生成的配送订单进行调度处理，以及对由于缺货原因产生的缺货订单，在来货后，修改定单状态。

配送系统的协调中心，是信息流在内部各门的起点

手工调度、自动调度、缺货订单状态修改、任务单查询。

- 调度

  - 订单详细信息

    接口：order下面的分页查询

    执行任务分站：

  - 手动调度

    手工选择收货人所属分站

    功能点：提交：进行调度操作，产生**任务单**及**调拨出库单**，并显示调度完成。

  - 自动调度

    自动调度的查询界面和选择界面与手工调度相同，不用手工选择分站，程序会自动取订单中的收货人所在分站为投递分站。

- 订单状态修改

  订单状态修改的主要功能是“挂起订单”到货后修改定单状态为可分配。(“缺货”的订单即为“挂起”)

- 任务单查询

  接口：任务单的分页查询

  “要求完成日期”、“任务类型”、“任务状态”、“选择分站”查询符合条件的任务单。

- 商品调拨

  - 库房商品查询

    查询库房商品的实际库存量

  - 商品调拨


### 分站管理

分站的主要工作是直接面向客户，为客户提供服务。功能包括：

- 配送任务单查询

  - 条件查询：日期、类型、状态

- 配送任务分配

  制定配送员

  将本分站可分配的订单分配指定的配送员，并生成配送出库单。该单，就是操作“任务单签收单表”，只是在调度中心不予分配投递员，而在分站进行投递员的指定和分配操作。

  查询的结果只包含任务状态为“可分配”的任务

- 打印配送单

  根据要求完成日期、任务类型、配送员条件，查询符合条件的任务单。
  查询结果如下：
  任务号、客户姓名、投递地址、投递员、任务生成日期、要求完成日期、任务类型。

- 回执录入、

  - 回执任务单查询
  - 回执任务单录入

- 缴款查询（这个取消，因为先付款后送的货）

- 发票管理

  - 发票查询
  - 发票领用/退回

### 库房管理

对货物出入库、货物存放进行管理。

主要业务包括：

- 中心库房购货入库、

  - 查询
  - 入库操作

- 中心库房调拨出库、

  根据调拨单进行调拨，并将订单状态修改为中心库房出库

  - 调拨出库
  - 打印出库单
  - 打印分发单

- 分站库房调拨入库、

  入库：订单状态改为“配送站到货”，将任务单状态改为“可分配”。

- 退货管理、

  - 退货登记
  - 分站库房退货出库
  - 中心库房退货入库
  - 中心库房退货供应商

- 领货管理。

  领货是指分站库房根据调拨单及配送员的配送任务单（其实就是任务单，无非查询显示的字段不同而己）领取货物。输入正确的日期段、选择出入库类型为“调拨出库”，进行查询，显示需要进行调拨出库的列表，包含以下内容：

  选择项、调拨单号、商品代码、商品名称、计量单位、数量、任务号、日期功能点：

  领货：将订单及任务单状态修改为“已领货”。

### 配送中心

配送中心的主要职责是对配送业务进行管理。

- 业务开发、

  - 商品管理
  - 商品类型管理
  - 订单类型管理

- 进货管理、

  - 供应商管理
  - 进货管理
    - 缺货检查
    - 进货登记
  - 退货管理

- 业务管理

  对配送业务进行统计分析，出一些报表。主要功能有：

  - 订购排行榜查询、
  - （客户满意度分析）
  - 分站配送情况分析。

- 库房管理

  设置库房基础信息，查询库房的库存量及出入库情况。主要功能有：

  - 库房代码设置、
  - 库房储备设置、
  - 库存量查询、
  - 出入库查询

### 财务管理

- 发票管理
- 与供应商结算
- 与分站结算

### 仓库管理

角色：仓库管理员

- 区域中心仓库增删改查

### 商品管理

角色：配货管理员

- 商品管理
  - CRUD
- 进货管理/SKU
  - 

### 订单管理

- 查看所有订单
  - 按用户
  - 按仓库
  - 按分站

## 用户端

- 用户账户
  - 邮箱登录
  - 密码登录
  - 邮箱注册
  - 登出
  - 信息修改
  
- 地址管理
  - CRUD
  - 设为默认
  
- 购物信息

  - 首页信息
  - 商品分类
  - 商品搜索
  - 商品详情
    - 

- 下单管理

    - 确认下单

    - 订单列表

    - 修改订单

      只能改收货地址等信息，无法改商品列表，要换只能退订换货

    - 换货

      即退订 + 新订

    - 订单详情

      - 概要信息
      - 物流信息

- 购物车管理

  - CRUD
  - 选中下单






后端：后端所有工作，数据库设计、模块设计、功能设计、中间件引入、微服务拆分、接口开发
前端：

- 权限管理模块，用户管理（增、删、改、条件分页查询、授权角色）、角色管理（增、删、改、条件分页查询、授权权限）、权限管理（树形列表展示、增、删、改、条件分页查询、授权权限）、
- 登录注册模块，用户登录（密码登录、验证码登录）、用户注册、忘记密码

后端：后端所有工作，数据库设计、模块设计、功能设计、中间件引入、微服务拆分、接口开发
前端：

- 权限管理模块，用户管理、用户授权、角色管理、角色授权、权限管理
- 登录注册模块，用户登录、验证码登录、用户注册、密码找回

后端完成度90%、前端完成度90%
