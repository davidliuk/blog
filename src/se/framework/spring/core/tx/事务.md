# 事务

## 事务传播

Spring事务传播机制是指在多个事务方法相互调用时，如何处理事务的传播和隔离。Spring提供了多种事务传播机制，包括REQUIRED、SUPPORTS、MANDATORY、REQUIRES_NEW、NOT_SUPPORTED、NEVER和NESTED等。以下是各种事务传播机制的具体实现：

1. REQUIRED：如果当前存在事务，则加入该事务；如果当前不存在事务，则创建一个新的事务。

2. SUPPORTS：如果当前存在事务，则加入该事务；如果当前不存在事务，则以非事务方式执行。

3. MANDATORY：如果当前存在事务，则加入该事务；如果当前不存在事务，则抛出异常。

4. REQUIRES_NEW：创建一个新的事务，并挂起当前事务（如果存在）。

5. NOT_SUPPORTED：以非事务方式执行，并挂起当前事务（如果存在）。

6. NEVER：以非事务方式执行，并抛出异常（如果当前存在事务）。

7. NESTED：如果当前存在事务，则在该事务中嵌套一个新的事务；如果当前不存在事务，则创建一个新的事务。

## 事务管理

### 状态管理

在Spring中，可以通过TransactionSynchronizationManager类来判断当前是否存在事务。该类提供了一个静态方法isActualTransactionActive()，用于判断当前是否存在事务。如果返回true，则表示当前存在事务；如果返回false，则表示当前不存在事务。

总之，Spring事务传播机制可以帮助我们处理多个事务方法之间的关系，以保证数据的一致性和完整性。在使用事务传播机制时，需要根据实际情况选择合适的传播机制，并注意事务的隔离级别和传播特性，以便实现正确的业务逻辑。