# 线程池



## 好处

池化技术：线程池、数据库连接池、Http 连接池等等都是对这个思想的应用。池化技术的思想主要是为了减少每次获取资源的消耗，提高对资源的利用率。

**线程池**提供了一种限制和管理资源（包括执行一个任务）的方式。 每个**线程池**还维护一些基本统计信息，例如已完成任务的数量。

这里借用《Java 并发编程的艺术》提到的来说一下**使用线程池的好处**：

- **降低资源消耗**。通过重复利用已创建的线程降低线程创建和销毁造成的消耗。
- **提高响应速度**。当任务到达时，任务可以不需要等到线程创建就能立即执行。
- **提高线程的可管理性**。线程是稀缺资源，如果无限制的创建，不仅会消耗系统资源，还会降低系统的稳定性，使用线程池可以进行统一的分配，调优和监控。



## 核心参数

![截屏2023-02-02 11.10.58](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/3978/%E6%88%AA%E5%B1%8F2023-02-02%2011.10.58.png)



### 核心概念

线程

- 核心线程：运行完任务以后依然保留在线程池当中
- 救急线程：运行完任务以后抛弃不保留



### 初始参数

1. corePoolSize 核心线程树木

   - 最多**保留**的线程数，可以为0

2. maximumPoolSize最大线程数目

   - 核心线程 + 救急线程

3. keepAliveTime 生存时间

   针对救急线程，执行完成以后存留的时间的数字，如20，30等

4. unit

   针对救急线程，执行完成以后存留的时间的单位，如秒、毫秒等

5. workQueue 任务队列上限

   阻塞队列

6. threadFactory 线程工厂

7. handler 拒绝策略

   四种，线程池、等待队列、救急线程都满的时候，如何处理

   - AbortPolicy，爆异常
   - CallerRunsPolicy，调用者自己去运行这个任务
   - DiscardPolicy，新加入的丢弃掉
   - DiscardOldestPolicy，把任务队列中等待最久的（最先加入队列的）丢弃掉，然后新任务加入进来



核心线程都在忙的时候，放入任务队列，任务队列也满的时候，进入救急线程


